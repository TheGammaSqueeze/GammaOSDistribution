<?xml version="1.0" encoding="UTF-8"?>
<!--
    The wizard:uris recorded here have the inconvenience of being generated by hand, but they allow
    for the full spread of launch flags (we need FLAG_ACTIVITY_NEW_TASK [0x10000000]), where the
    <intent> tag processed by Intent.parseIntent() does not.

    adb shell am to-intent-uri -a com.android.setupwizard.WELCOME -f 0x10000000 \-\-ez firstRun true
-->
<WizardScript xmlns:wizard="http://schemas.android.com/apk/res/com.google.android.setupwizard"
    wizard:version="2">

     <!-- Rollback auth early update when required [REQUIRED] -->
    <WizardAction id="rollback_auth_early_update"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.AUTH_EARLY_UPDATE_ROLLBACK;end">
         <result wizard:name="skip"
            wizard:resultCode="1"
            wizard:action="POST_CHECKIN" />
    </WizardAction>

    <!-- Check network availability and return RESULT_OK or RESULT_SKIP [REQUIRED] -->
    <WizardAction id="network_check_after_rollback"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.NETWORK_CHECK;end">
        <result wizard:name="skip"
            wizard:resultCode="1"
            wizard:action="POST_CHECKIN" />
    </WizardAction>

    <!-- run gms checkin again after auth early update rollback [REQUIRED] -->
    <WizardAction id="gms_checkin_after_rollback"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.GMS_CHECKIN;end">
        <result wizard:name="timeout"
            wizard:resultCode="101"
            wizard:action="network_timeout" />
        <result wizard:action="POST_CHECKIN" />
    </WizardAction>

    <!-- Network or check-in timeout [REQUIRED] -->
    <WizardAction id="network_timeout"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.NETWORK_TIMEOUT;end" />

    <!-- Add any more steps that need to run after rollback here -->

    <!-- Placeholder to skip actions that usually run after rollback [REQUIRED]-->
    <WizardAction id="POST_CHECKIN" />
</WizardScript>
