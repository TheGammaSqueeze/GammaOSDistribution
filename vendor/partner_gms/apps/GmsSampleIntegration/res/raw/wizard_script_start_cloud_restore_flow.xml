<?xml version="1.0" encoding="UTF-8"?>
<!--
    The wizard:uris recorded here have the inconvenience of being generated by hand, but they allow
    for the full spread of launch flags (we need FLAG_ACTIVITY_NEW_TASK [0x10000000]), where the
    <intent> tag processed by Intent.parseIntent() does not.

    adb shell am to-intent-uri -a com.android.setupwizard.WELCOME -f 0x10000000 \-\-ez firstRun true
-->
<WizardScript xmlns:wizard="http://schemas.android.com/apk/res/com.google.android.setupwizard"
    wizard:firstAction="restore_check">

    <!-- Restore apps from the cloud [RECOMMENDED] -->
    <!-- Check to see if we already know which device is being restored onto this one -->
    <WizardAction id="restore_check"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.CHECK_RESTORE_TOKEN;end">
        <result wizard:name="token_not_found"
            wizard:resultCode="101"
            wizard:action="restore_picker" />
        <result wizard:name="choose_what_to_restore"
            wizard:resultCode="102"
            wizard:action="choose_what_to_restore" />
        <result wizard:action="restore_start" />
    </WizardAction>

    <!-- Choose what to restore. If restore token was not provided, also choose which backup set to restore from -->
    <WizardAction id="choose_what_to_restore"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.CHOOSE_WHAT_TO_RESTORE;end">
        <result wizard:name="skip"
            wizard:resultCode="1" />
        <result wizard:name="no_content"
            wizard:resultCode="2" />
        <result wizard:action="restore_start" />
    </WizardAction>

    <!-- Select a device to serve as the source for restored apps and start restoring -->
    <WizardAction id="restore_picker"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.RESTORE;end">
        <result wizard:name="skip"
            wizard:resultCode="1" />
        <result wizard:name="no_content"
            wizard:resultCode="2" />
        <result wizard:action="restore_start" />
    </WizardAction>

    <WizardAction id="restore_start"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.START_RESTORE;end" />

</WizardScript>
