<?xml version="1.0" encoding="UTF-8"?>
<!--
    Legend:
        REQUIRED     Must be included in final scripting solution
        RECOMMENDED  Associated with an optional feature; may have
                     dependencies on other recommended actions
        CUSTOMIZABLE Available for modification, within UX standards

    Each top-level comment tag applies to one or more script instructions, until the next top-level
    comment tag. A comment tag on a result code applies only to that result code.

    The wizard:uris recorded here have the inconvenience of being generated by hand, but they allow
    for the full spread of launch flags (we need FLAG_ACTIVITY_NEW_TASK [0x10000000]), where the
    <intent> tag processed by Intent.parseIntent() does not.

    adb shell am to-intent-uri -a com.android.setupwizard.WELCOME -f 0x10000000 \-\-ez firstRun true
-->
<WizardScript xmlns:wizard="http://schemas.android.com/apk/res/com.google.android.setupwizard"
    wizard:version="2">

    <!-- Welcome screen for deferred setup [RECOMMENDED, CUSTOMIZABLE] -->
    <WizardAction id="welcome"
        wizard:uri="intent:#Intent;action=com.android.setupwizard.DEFERRED_WELCOME;end" />


    <!-- Wait for Play Store updates that are already in flight to complete [RECOMMENDED] -->
    <WizardAction id="complete_in_flight_updates"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.COMPLETE_IN_FLIGHT_UPDATES;end" />


    <!-- Check which existing profile should be enabled [RECOMMENDED, CUSTOMIZABLE] -->
    <WizardAction id="slots_selection"
        wizard:uri="intent:#Intent;action=com.android.setupwizard.SLOTS_SELECTION;end">
        <result wizard:name="skip"
            wizard:resultCode="1"
            wizard:action="sim_missing" />
        <result wizard:action="carrier_setup" />
    </WizardAction>


    <!-- Notify user if expected SIM is not found [RECOMMENDED, CUSTOMIZABLE] -->
    <WizardAction id="sim_missing"
        wizard:uri="intent:#Intent;action=com.android.setupwizard.SIM_MISSING;end">
        <result wizard:name="esim"
            wizard:resultCode="101"
            wizard:action="esim_intro" />
        <result wizard:name="esim_only"
            wizard:resultCode="102"
            wizard:action="carrier_setup" />
        <result wizard:action="sim_ready" />
    </WizardAction>

    <WizardAction id="sim_ready"
        wizard:uri="intent:#Intent;action=com.android.setupwizard.SIM_READY;end" >
        <result wizard:action="carrier_setup" />
    </WizardAction>

    <WizardAction id="esim_intro"
        wizard:uri="intent:#Intent;action=com.android.setupwizard.ESIM_INTRO;end" />

    <!-- Activate carrier services [RECOMMENDED] -->
    <WizardAction id="carrier_setup"
        wizard:uri="intent:#Intent;action=com.android.setupwizard.CARRIER_SETUP;end">
        <result wizard:name="all_subscriptions_completed"
            wizard:resultCode="98765"
            wizard:action="sim_setup" />

        <!-- Return to carrier_setup to check for other subscriptions for multi-SIM -->
        <result wizard:action="carrier_setup" />
    </WizardAction>

    <!-- On multi-SIM devices, choose which SIM to use for voice, data, and text [RECOMMENDED, CUSTOMIZABLE] -->
    <WizardAction id="sim_setup"
        wizard:uri="intent:#Intent;action=com.android.setupwizard.SIM_SETUP;end" />

    <!-- Network selection and packages update [REQUIRED, CUSTOMIZABLE] -->
    <WizardAction id="connect_and_update"
        wizard:script="android.resource://com.google.android.gmsintegration/raw/wizard_script_connect_and_update_flow">
        <result wizard:name="no_connection"
            wizard:resultCode="1"
            wizard:action="no_network_flow" />
    </WizardAction>

    <!-- Restore from an existing account or device [RECOMMENDED, CUSTOMIZABLE] -->
    <WizardAction id="unified_restore_flow"
        wizard:script="android.resource://com.google.android.gmsintegration/raw/wizard_script_unified_restore_flow">
        <result wizard:action="kid_post_setup" />
    </WizardAction>


    <!-- Set up without a network connection [RECOMMENDED] -->
    <WizardAction id="no_network_flow"
        wizard:script="android.resource://com.google.android.gmsintegration/raw/wizard_script_no_network_flow">
        <result wizard:action="kid_post_setup" />
    </WizardAction>


    <!-- Google kid account setup. [REQUIRED] -->
    <WizardAction id="kid_post_setup"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.KID_POST_SETUP;end" />


    <!-- Leave Setup Wizard [REQUIRED] -->
    <WizardAction id="exit"
        wizard:uri="intent:#Intent;action=com.android.setupwizard.EXIT;end" />

</WizardScript>
